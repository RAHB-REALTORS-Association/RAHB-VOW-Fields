<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RAHB VOW Fields Display</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1>RAHB VOW Fields</h1>
        <input type="text" id="searchInput" class="form-control" placeholder="Search Fields" onkeyup="searchTable()">
        <table class="table table-striped mt-3" id="dataTable">
            <thead>
                <tr>
                    <th>DD Field</th>
                    <th>Source Field</th>
                    <th>Field Description</th>
                    <th>Selected</th>
                    <th>Resource</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <!-- Data will be inserted here -->
            </tbody>
        </table>
    </div>

    <!-- Bootstrap JS (optional) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        // CSV Parsing Function
        function parseCSV(text) {
            let lines = text.split('\n');
            let result = [];
            let headers = lines[0].split(',');

            for(let i = 1; i < lines.length; i++) {
                let obj = {};
                let currentline = lines[i].split(',');
                let j = 0, temp = '';

                for (let cell of currentline) {
                    if (cell.startsWith('"') && !cell.endsWith('"')) {
                        temp = cell;
                    } else if (!cell.startsWith('"') && cell.endsWith('"')) {
                        temp += ',' + cell;
                        obj[headers[j]] = temp.slice(1, -1);
                        temp = '';
                        j++;
                    } else if (temp !== '') {
                        temp += ',' + cell;
                    } else {
                        obj[headers[j]] = cell;
                        j++;
                    }
                }

                result.push(obj);
            }
            return result;
        }

        // Load and parse the CSV file
        fetch('vow_fields.csv')
            .then(response => response.text())
            .then(data => {
                const parsedData = parseCSV(data);
                const table = document.getElementById('tableBody');

                for (const row of parsedData) {
                    const tr = document.createElement('tr');
                    for (const [key, value] of Object.entries(row)) {
                        const td = document.createElement('td');
                        td.textContent = value;
                        tr.appendChild(td);
                    }
                    table.appendChild(tr);
                }
            });

        // Implement search functionality
        function searchTable() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const table = document.getElementById('dataTable');
            const rows = table.getElementsByTagName('tr');

            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                let match = false;

                for (const cell of cells) {
                    const text = cell.textContent.toLowerCase();
                    if (text.includes(input)) {
                        match = true;
                        break;
                    }
                }

                rows[i].style.display = match ? '' : 'none';
            }
        }
    </script>
</body>
</html>

